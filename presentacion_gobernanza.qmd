---
title: "Centralidad y  resiliencia ante desastres por inundaciones:"
subtitle: "<span style='color:#bd292e'>Un caso de estudio en Rio Grande do Sul</span>"
date: "2024-10-03"
date-format: long
author: "Ricardo Ruiz Sánchez"
institute: "HeiGIT & ITC Enschede (GIMA)"
keywords: 
  - Centralidad de redes
  - Gobernnza del riesgo de desastres
  - Resiliencia urbana 
editor: visual
repo-url: https://rruiz-s.github.io/heigit_presentation/heigit_presentation.html#/title-slide
format:
  revealjs:
    width: 1400
    margin: 0
    incremental: false
    theme: [default, custom.scss]
    toc-depth: 2
    code-fold: true
    code-link: true
    code-line-numbers: true
    logo: images/logo_wide.png
    slide-number: true
    footer: "Estudiante del máster [GIMA](https://www.uu.nl/en/masters/geographical-information-management-and-applications-gima) y  practicante en el departamento de Geoinformación para ayuda huanitaria en [HeiGIT](https://heigit.org/geoinformation-for-humanitarian-aid/).  <br> Código de la presentación disponible en [GitHub](https://rruiz-s.github.io/heigit_presentation/heigit_presentation.html#/title-slide)."
    progress: true
    title-slide-attributes:
      data-background-size: contain
    toc-title: Content
    chalkboard: true
---
# Corpus Teórico

```{r}
#| eval: false

library(DBI)
library(tidyverse)
library(sf)
eisenberg_connection <- DBI::dbConnect(RPostgres::Postgres(),
                          user= "docker",
                          password = "docker",
                          host = "localhost",
                          dbname="gis",
                          port = 25432)
pre_network_largest <- st_read(eisenberg_connection, "porto_alegre_net_largest")
porto_alegre_net_pre_ors <- st_read(eisenberg_connection,"porto_alegre_net_pre_ors")

porto_alegre_net_pre_ors |>
  dplyr::select(c(-unidirectid, -bidirectid)) |>
  rename(id = ogc_fid) |> 
  mutate(weight=round(weight,2),
         the_geom = as.character(the_geom)) |> 
  slice(1:5) |>
  DT::datatable()

centrality_weighted_100_bidirect_cleaned <- st_read(eisenberg_connection,"centrality_weighted_100_bidirect_cleaned")
```


## Análisis de redes{.smaller}
### Origen de la <span style="color:#bd292e">teoría de grafos</span>

::::{.columns}

:::{.column width=75%}

:::{.r-stack}

![](/images/map_0.png)

![](/images/map_1.png){.fragment}

![](/images/map_3.png){.fragment}

:::

:::

:::{.column width=25%}

$$
G = (V,E)
$$
 Siglo XVIII Matemático suizo Leonhard Euler 
 
 > <font size="4">¿Es posible dar un paseo comenzando desde cualquiera de estas regiones, pasando por todos los puentes, recorriendo solo una vez cada uno, y regresando al mismo punto de partida?</font>

:::

::::

## Análisis de redes
### Uso en <span style="color:#bd292e">gobernanza de redes</span>

:::{.columns}
:::{.column width="50%"}
![](images/redes_gobernanza.png)
:::
:::{.column width="50%"}

<font size="6">Gobernanza eficaz y legitimidad en dos redes de Derechos Territoriales de Uso para la Pesca en dos redes de gobernanza (TURF)</font>

:::{.fragment}
><font size="6">¿Cómo están conectados los patrones de legitimidad en una red de gobernanza de recursos naturales con la colaboración y los resultados efectivos de la gobernanza?</font>
:::

:::
:::

## Análisis de redes
### Uso en <span style="color:#bd292e">ayuda humanitaria</span>

:::{.columns}

:::{.column width=50%}

![](images/intervation_map.png){fig-align="left" width=6.35in height=4.6in}

:::

:::{.column width="50%"}

![](images/venn_diagram.jpeg){width=5.2in height=2.2in .fragment}
![](images/7_steps_fbf.png){width=5.2in height=2.2in .fragment}
:::

:::{.notes}
•anticipate disasters, prevent their impact, if possible, and reduce human suffering and losses
Monitored forecasts instantly trigger a danger level warning, when a set threshold is exceeded, and releases funds for regions under threat – before the disaster even happens.
- enable access to humanitarian funding for early action based on in-depth forecast information and risk analysis
:::
:::

## Análisis de redes

### Uso en <span style="color:#bd292e">ayuda humanitaria</span>

:::{.columns}
:::{.column width="50%"}

![](images/inform_index.png)
<font size="4"><b>Índice INFORM:</b></font><font size="4"> Factores que contribuyen al riesgo de crisis humanitarias y desastres</font>

:::
:::{.column width="50%"}
![](images/coping_capacity.png){width=7.5in height=3.75in}
<font size="4"><b>Evacuation times:</b></font><font size="4">Pakistan, travel time/distance to the nearest not flood affected location.</font>

:::

:::

## Análisis de redes
### En <span style="color:#bd292e">HeiGIT:Proyectos fbf</span>

# Marco Contextual  <br> y Estudio de Caso 

## Marco contextual

### Uso de grafos en <span style="color:#bd292e">redes de transporte</span>: 

::::{.columns}
:::{.column width=50%}

![Ponte do Guaiba en Porto Alegre, Rio Grande do Sul (BR)](/images/bridge_before.jpg){width=6in fig-align="center"}
:::

:::{.column width=50%}

![](/images/bridge_after.png){height=4in fig-align="center" .fragment}
:::

::::

## Estudio de caso

### <span style="color:#bd292e">Inundaciones en Rio Grande do Sul</span>
::::{.columns}

:::{.column width=60%}

```{=html}

<iframe width="870" height="470" src="/media/hot_intro.html" title = "Sum Edge Betweenness in the Urban Settlement located in Porto Alegre" data-external="1"></iframe>
```

:::

:::{.column width=40%}

![](/images/g2041.png){.absolute top="200" left="850" width="400" height="300"}

:::

::::

::: {.notes}
Expliquen la situación específica que están investigando, el contexto del estudio de caso y por qué es un problema crítico que requiere estudio.
:::

## Estudio de caso

### <span style="color:#bd292e">Marco conceptual</span>

![](images/framework_heigit.png){width=10.5in height=4.8in fig-align="center"}

# Pregunta de Investigación

::: {.incremental}

1. ¿Cómo la evaluación de la centralidad identifica zonas críticas en la red de transporte y nodos relevantes? 
2. ¿Cómo facilita una gobernanza orientada a la resiliencia urbana ante inundaciones?

:::

:::{.notes}
Expongan la pregunta principal (por ejemplo, cómo la gobernanza puede mejorar la gestión de inundaciones) y justifiquen su relevancia.
:::



## Metodología

### <span style="color:#bd292e">Diseño técnico</span>

![](images/workflow_methodology.png){width=10.5in height=4in  fig-align="center"}

::: {.notes}
Objetivo y temática: Mejorar la resiliencia urbana identificando carreteras críticas a través del análisis de centralidad en un escenario de inundación.
Presenten el título del proyecto y el objetivo principal, indicando el tema central y qué buscan lograr con la investigación.
:::

## Metodología

### Aristas: <span style="color:#bd292e">OpenStreetMap & OpenRouteService</span>

:::{.columns}
:::{.column width="70%"}
```{=html} 
<iframe width="900" height="420" src="/media/osm_ors.html" title = "Origin and destination used and network" data-external="1"></iframe>
```
:::
:::{.column width="30%"}
![](images/openrouteservice.jpg){width="50%"}
![](images/osm.png){width="50%"}
:::
:::


## Metodología

### Vértices: <span style="color:#bd292e">Origenes-Destinos</span> 

:::{.columns}

:::{.column width="70%"}

```{=html}

<iframe width="900" height="420" src="/media/map_sampling_example_v0.html" title = "Origin and destination used and network" data-external="1"></iframe>
```

:::

:::{.column width="30%"}

$$
\scriptstyle c_{B}(v) = \sum_{\substack{s \neq t \neq v \\ s,t \in V}} \frac{\sigma(s,t|v)}{\sigma(s,t)}
$$

<font size="5">
  <ul>
    <li><b>Datos</b></li>
    <ul>
      <li><b>Global Human Settlement</b></li>
      <li><b>Capa de inundación</b></li>
      <li><b>Muestras: Matriz </b><span style="color:#5EC0BE"><b>Origen</b></span> - <span style="color:#7C98C2"><b>Destino</b></span></li>
      <li><span style="color:#bd292e"><b>Hospitales</b></span></li>
    </ul>
  </ul>
</font>


:::

:::{.notes}
describan los indicadores que guían su análisis, como la participación de las partes interesadas, la coordinación interinstitucional y la distribución de responsabilidades.
:::

:::
## Metodología
### <span style="color:#bd292e">Métrica de centralidad</span>

```{sql}
#| connection: eisenberg_connection
#| code-summary: shortest path using pgrouting
#| code-overflow: scroll
#| eval: false
#| echo: true

 CREATE TABLE centrality_200_200_porto AS
 SELECT   b.ogc_fid,
 b.the_geom,
 count(the_geom) as centrality 
 FROM  pgr_dijkstra('
  SELECT  ogc_fid AS id,
          fromid AS source,
          toid AS target,
          weight AS cost
  FROM porto_alegre_net_largest',
    ARRAY(SELECT net_id AS start_id FROM porto_200_origin  ),
    ARRAY(SELECT net_id AS end_id FROM porto_200_destination ),
       directed := TRUE) j
                      LEFT JOIN porto_alegre_net_largest AS b
                      ON j.edge = b.ogc_fid
                      GROUP BY  b.ogc_fid, b.the_geom
                      ORDER BY centrality DESC; 
```

# Hallazgos iniciales

## <font size="7">Mapping changes <br> on</font>  <span style="color:#bd292e"><font size="7">edge betweenness</font></span>

```{=html}
<iframe width="1000" height="450" src="/media/laura_centrality_draft.html" title = "Origin and destination used and network" data-external="1"></iframe>
```


:::{.notes}
Señalen los hallazgos iniciales o el progreso hasta el momento, incluso si no han finalizado la recolección de datos. Destaquen algún patrón o tendencia importante.
:::

## Identifying most central roads

Table with highest connectivity roads

```{=html}
<iframe width="1200" height="550" src="/media/centrality_table_results.html" title = "Origin and destination used and network" data-external="1"></iframe>
```

# Conclusiones
